# ingredient-normalization

## Code Origin / Acknowledgement
本リポジトリのコードは、研究指導の一環として  
指導教員より提供された材料名統一の基礎コードをベースにしています。

本プロジェクトの前処理・NER 部分には、  
研究指導の一環として提供された既存コードを使用しています。

その上で、本リポジトリでは  
類似度設計・クラスタリング方法・未統一語彙の扱いなどについて  
自分で再設計・改良を行いました。

## My Contribution / Improvements

本研究では、既存コードで用いられていた
類似度融合スコア設計をそのまま用いるのではなく、
**評価可能な設計対象として再定義**しました。

具体的には以下を行っています。

- Cross-Encoder / Cosine Similarity / 文字列類似度の
  **重み（alpha, beta, gamma）および閾値を固定値ではなく
  最適化対象として扱う設計に変更**
- クラスタ内の意味的一貫性を評価指標として定義し、
  **グリッドサーチによるパラメータ最適化を実装**
- 閾値決定を固定値ではなく、
  **スコア分布に基づく分位点（quantile）方式に再設計**
- 既存の Bi-Encoder → Cross-Encoder の二段階構成を維持しつつ、
  **類似度設計の妥当性を定量的に検証可能にした**

  ## Pipeline
本リポジトリでは、以下の流れで材料名の統一を行います。

1. **正規化**
   - Unicode 正規化（NFKC）
   - 記号・表記ゆれの除去
2. **候補生成（Bi-Encoder）**
   - SentenceTransformer により材料名をベクトル化
   - コサイン類似度で Top-k 候補を抽出
3. **再ランク付け（Cross-Encoder）**
   - 候補ペアに対して文脈レベルの類似度を算出
4. **類似度スコアの融合**
   - Cross-Encoder
   - Cosine Similarity
   - 文字列類似度（Jaro-Winkler）
5. **グラフ構築とクラスタリング**
   - 融合スコアが閾値を超えたペアをエッジとしてグラフ化
   - 連結成分を同義語クラスタとして扱う
6. **代表語（canonical）の決定**
   - クラスタ内の平均類似度が最大となる語を代表表記として採用

   ## Code Origin
本プロジェクトの前処理・NER 部分には、  
研究指導の一環として提供された既存コードを使用しています。

本リポジトリでは、その後段の  
**類似度設計・クラスタリング・統一ロジック**を  
自作・改良部分として公開しています。


